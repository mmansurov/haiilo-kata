<div>
  <div class="cart-header">
    <h2>Shopping Cart</h2>
  </div>
  <div class="cart-content">
    <div>
      <div class="cart-item" *ngFor="let cartItem of cartItems$ | async">
        <div>
          <span>{{ cartItem.item.name }}</span>
          <span>x{{ cartItem.quantity }}</span>
          <span>{{ cartItem.totalPrice }}€</span>
        </div>
      </div>
    </div>
  </div>
  <div class="cart-footer">
    <div>Total: {{ total$ | async }}€</div>
    <button (click)="checkout()" [disabled]="!(cartItems$ | async)?.length">
      Proceed to Checkout
    </button>
  </div>
</div>

<ng-container *ngIf="checkoutError$ | async as error">
  <div *ngIf="error.message">
    <div class="alert-content">
      <p>{{ error.message }}</p>
      <div *ngIf="error.itemWithPriceChange && error.actualPrice">
        <p>
          <strong>{{ error.itemWithPriceChange.name }}</strong> price has changed:
        </p>
        <p>
          <span>{{ error.itemWithPriceChange.currentPriceValue }}€</span> →
          <span>{{ error.actualPrice }}€</span>
        </p>
      </div>
    </div>
    <div>
      <button (click)="refreshPrices()">Update Prices</button>
    </div>
  </div>
</ng-container>
